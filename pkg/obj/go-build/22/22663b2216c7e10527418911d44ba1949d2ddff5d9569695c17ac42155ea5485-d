// Code generated by cmd/cgo; DO NOT EDIT.

//line /Users/fpf/Downloads/go1.11.1/misc/cgo/test/issue3775.go:1:1
// +build !android

package cgotest

/*
void lockOSThreadCallback(void);
inline static void lockOSThreadC(void)
{
        lockOSThreadCallback();
}
int usleep(unsigned usec);
*/
import _ "unsafe"

import (
	"runtime"
	"testing"
)

func init() {
	// Same as test3775 but run during init so that
	// there are two levels of internal runtime lock
	// (1 for init, 1 for cgo).
	// This would have been broken by CL 11663043.
	(_Cfunc_lockOSThreadC)()
}

func test3775(t *testing.T) {
	// Used to panic because of the UnlockOSThread below.
	(_Cfunc_lockOSThreadC)()
}

//export lockOSThreadCallback
func lockOSThreadCallback() {
	runtime.LockOSThread()
	runtime.UnlockOSThread()
	go (_Cfunc_usleep)(10000)
	runtime.Gosched()
}
