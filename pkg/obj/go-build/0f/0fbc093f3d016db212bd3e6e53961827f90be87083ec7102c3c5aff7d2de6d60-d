// Code generated by cmd/cgo; DO NOT EDIT.

//line /Users/fpf/Downloads/go1.11.1/misc/cgo/test/issue17537.go:1:1
// Copyright 2016 The Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

// Issue 17537.  The void* cast introduced by cgo to avoid problems
// with const/volatile qualifiers breaks C preprocessor macros that
// emulate functions.

package cgotest

/*
#include <stdlib.h>

typedef struct {
	int i;
} S17537;

int I17537(S17537 *p);

#define I17537(p) ((p)->i)

// Calling this function used to fail without the cast.
const int F17537(const char **p) {
	return **p;
}

// Calling this function used to trigger an error from the C compiler
// (issue 18298).
void F18298(const void *const *p) {
}

// Test that conversions between typedefs work as they used to.
typedef const void *T18298_1;
struct S18298 { int i; };
typedef const struct S18298 *T18298_2;
void G18298(T18298_1 t) {
}
*/
import _ "unsafe"

import "testing"

func test17537(t *testing.T) {
	v := _Ctype_struct___6{i: 17537}
	if got, want := (_Cfunc_I17537)(&v), _Ctype_int(17537); got != want {
		t.Errorf("got %d, want %d", got, want)
	}

	p := (*_Ctype_char)((_Cfunc__CMalloc)(1))
	*p = 17
	if got, want := func(_cgo0 **_Ctype_char) _Ctype_int {;	_cgoCheckPointer(_cgo0, true);	return (_Cfunc_F17537)(_cgo0);}(&p), _Ctype_int(17); got != want {
		t.Errorf("got %d, want %d", got, want)
	}

	(_Cfunc_F18298)(nil)
	var v18298 _Ctype_T18298_2
	func(_cgo0 _Ctype_T18298_1) {;	_cgoCheckPointer(_cgo0);	(_Cfunc_G18298)(_cgo0);}(_Ctype_T18298_1(v18298))
}
